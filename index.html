<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰øÆ‰ªô‰∏ñÁïå - VueÁâà</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- ÁôªÂΩïÊ≥®ÂÜåÁïåÈù¢ -->
        <div v-if="!isLoggedIn" class="auth-container">
            <div class="auth-modal">
                <div class="auth-header">
                    <h1>üèÆ ‰øÆ‰ªô‰∏ñÁïå üèÆ</h1>
                    <p>Ë∏è‰∏ä‰ªôÈÄîÔºåÈóÆÈºéËãçÁ©π</p>
                </div>
                
                <div class="auth-tabs">
                    <button 
                        :class="['auth-tab', { active: authMode === 'login' }]"
                        @click="authMode = 'login'"
                    >
                        ÁôªÂΩï
                    </button>
                    <button 
                        :class="['auth-tab', { active: authMode === 'register' }]"
                        @click="authMode = 'register'"
                    >
                        Ê≥®ÂÜå
                    </button>
                </div>
                
                <form @submit.prevent="authMode === 'login' ? login() : register()" class="auth-form">
                    <div class="form-group">
                        <label>Áî®Êà∑Âêç</label>
                        <input 
                            type="text" 
                            v-model="authForm.username" 
                            placeholder="ËØ∑ËæìÂÖ•Áî®Êà∑Âêç"
                            required
                        >
                    </div>
                    
                    <div class="form-group">
                        <label>ÂØÜÁ†Å</label>
                        <input 
                            type="password" 
                            v-model="authForm.password" 
                            placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å"
                            required
                        >
                    </div>
                    
                    <div v-if="authMode === 'register'" class="form-group">
                        <label>Á°ÆËÆ§ÂØÜÁ†Å</label>
                        <input 
                            type="password" 
                            v-model="authForm.confirmPassword" 
                            placeholder="ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å"
                            required
                        >
                    </div>
                    
                    <button type="submit" class="auth-submit">
                        {{ authMode === 'login' ? 'ÁôªÂΩï' : 'Ê≥®ÂÜå' }}
                    </button>
                </form>
                
                <div v-if="authError" class="auth-error">
                    {{ authError }}
                </div>
            </div>
        </div>
        
        <!-- Ê∏∏Êàè‰∏ªÁïåÈù¢ -->
        <div v-if="isLoggedIn" class="game-container">
            <!-- È°∂ÈÉ®Áä∂ÊÄÅÊ†è -->
            <header class="status-bar">
                <div class="player-info">
                    <div class="player-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                    <div class="player-details">
                        <h3>{{ currentUser.username }}</h3>
                        <p>{{ player.realm }} {{ player.level }}Â±Ç</p>
                    </div>
                </div>
                
                <div class="status-bars">
                    <div class="status-item">
                        <label>ÁîüÂëΩÂÄº</label>
                        <div class="progress-bar">
                            <div class="progress-fill hp" :style="{ width: (player.hp / player.maxHp) * 100 + '%' }"></div>
                            <span class="progress-text">{{ player.hp }}/{{ player.maxHp }}</span>
                        </div>
                    </div>
                    
                    <div class="status-item">
                        <label>ÁÅµÂäõÂÄº</label>
                        <div class="progress-bar">
                            <div class="progress-fill mp" :style="{ width: (player.mp / player.maxMp) * 100 + '%' }"></div>
                            <span class="progress-text">{{ player.mp }}/{{ player.maxMp }}</span>
                        </div>
                    </div>
                    
                    <div class="status-item">
                        <label>‰øÆ‰∏∫</label>
                        <div class="progress-bar">
                            <div class="progress-fill exp" :style="{ width: (player.exp / player.maxExp) * 100 + '%' }"></div>
                            <span class="progress-text">{{ player.exp }}/{{ player.maxExp }}</span>
                        </div>
                    </div>
                </div>
                
                <div class="resources">
                    <div class="resource-item">
                        <span class="resource-icon">üí∞</span>
                        <span>{{ player.gold }}</span>
                    </div>
                    <div class="resource-item">
                        <span class="resource-icon">üíé</span>
                        <span>{{ player.spiritStones }}</span>
                    </div>
                    <div class="resource-item">
                        <span class="resource-icon">‚≠ê</span>
                        <span>{{ player.cultivationPoints }}</span>
                    </div>
                </div>
                
                <div class="user-actions">
                    <button @click="saveGame" class="save-btn" :disabled="saving">
                        {{ saving ? '‰øùÂ≠ò‰∏≠...' : 'üíæ ‰øùÂ≠ò' }}
                    </button>
                    <button @click="logout" class="logout-btn">üö™ ÈÄÄÂá∫</button>
                </div>
            </header>
            
            <!-- ‰∏ªÊ∏∏ÊàèÂå∫Âüü -->
            <main class="game-main">
                <!-- Â∑¶‰æßÈù¢Êùø -->
                <aside class="left-panel">
                    <div class="panel-tabs">
                        <button 
                            v-for="tab in leftTabs" 
                            :key="tab.id"
                            :class="['tab-btn', { active: activeLeftTab === tab.id }]"
                            @click="activeLeftTab = tab.id"
                        >
                            {{ tab.icon }} {{ tab.name }}
                        </button>
                    </div>
                    
                    <!-- ‰øÆÁÇºÈù¢Êùø -->
                    <div v-if="activeLeftTab === 'cultivation'" class="tab-content">
                        <div class="cultivation-methods">
                            <div class="method-card">
                                <h4>üßò ÊâìÂùêÂÜ•ÊÉ≥</h4>
                                <p>Âü∫Á°Ä‰øÆÁÇºÊñπÂºèÔºåÁ®≥ÂÆöËé∑Âæó‰øÆ‰∏∫</p>
                                <button 
                                    @click="startCultivation('meditation')"
                                    :disabled="isCultivating"
                                    class="method-btn"
                                >
                                    {{ isCultivating && cultivationType === 'meditation' ? '‰øÆÁÇº‰∏≠...' : 'ÂºÄÂßã‰øÆÁÇº' }}
                                </button>
                            </div>
                            
                            <div class="method-card">
                                <h4>‚ö° ÈòµÊ≥ï‰øÆÁÇº</h4>
                                <p>Ê∂àËÄóÁÅµÁü≥ÔºåÂø´ÈÄüÊèêÂçá‰øÆ‰∏∫</p>
                                <p class="cost">Ê∂àËÄóÔºö1ÁÅµÁü≥/ÂàÜÈíü</p>
                                <button 
                                    @click="startCultivation('formation')"
                                    :disabled="isCultivating || player.spiritStones < 1"
                                    class="method-btn"
                                >
                                    {{ isCultivating && cultivationType === 'formation' ? '‰øÆÁÇº‰∏≠...' : 'ÂºÄÂßã‰øÆÁÇº' }}
                                </button>
                            </div>
                        </div>
                        
                        <div v-if="isCultivating" class="cultivation-timer">
                            <h4>‰øÆÁÇºËøõË°å‰∏≠</h4>
                            <div class="timer">{{ formatTime(cultivationTime) }}</div>
                            <button @click="stopCultivation" class="stop-btn">ÂÅúÊ≠¢‰øÆÁÇº</button>
                        </div>
                    </div>
                    
                    <!-- ÊäÄËÉΩÈù¢Êùø -->
                    <div v-if="activeLeftTab === 'skills'" class="tab-content">
                        <div class="skills-grid">
                            <div 
                                v-for="(skill, skillName) in player.skills" 
                                :key="skillName"
                                :class="['skill-card', { locked: skill.locked }]"
                            >
                                <div class="skill-icon">{{ getSkillIcon(skillName) }}</div>
                                <h4>{{ getSkillName(skillName) }}</h4>
                                <div class="skill-level">Á≠âÁ∫ß: {{ skill.level }}</div>
                                <button 
                                    @click="upgradeSkill(skillName)"
                                    :disabled="skill.locked || player.cultivationPoints < getUpgradeCost(skill.level)"
                                    class="upgrade-btn"
                                >
                                    {{ skill.locked ? 'Êú™Ëß£ÈîÅ' : `ÂçáÁ∫ß (${getUpgradeCost(skill.level)}‰øÆ‰∏∫)` }}
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ËÉåÂåÖÈù¢Êùø -->
                    <div v-if="activeLeftTab === 'inventory'" class="tab-content">
                        <div class="inventory-header">
                            <h4>ËÉåÂåÖ ({{ getInventoryCount() }}/50)</h4>
                        </div>
                        <div class="inventory-grid">
                            <div 
                                v-for="(item, index) in getInventoryItems()" 
                                :key="index"
                                class="inventory-slot occupied"
                                :title="item.name"
                                @click="useItem(item.name)"
                            >
                                <div class="item-icon">{{ getItemIcon(item.name) }}</div>
                                <div class="item-count">{{ item.count }}</div>
                            </div>
                            <div 
                                v-for="n in (50 - getInventoryCount())" 
                                :key="'empty-' + n"
                                class="inventory-slot"
                            ></div>
                        </div>
                    </div>
                    
                    <!-- ÊàêÂ∞±Èù¢Êùø -->
                    <div v-if="activeLeftTab === 'achievements'" class="tab-content">
                        <div class="achievements-list">
                            <div 
                                v-for="achievement in achievements" 
                                :key="achievement.id"
                                :class="['achievement-card', { completed: achievement.completed }]"
                            >
                                <div class="achievement-icon">{{ achievement.icon }}</div>
                                <div class="achievement-info">
                                    <h4>{{ achievement.name }}</h4>
                                    <p>{{ achievement.description }}</p>
                                    <div class="achievement-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" :style="{ width: Math.min(100, (achievement.current / achievement.target) * 100) + '%' }"></div>
                                        </div>
                                        <span class="progress-text">{{ achievement.current }}/{{ achievement.target }}</span>
                                    </div>
                                    <div v-if="achievement.completed" class="achievement-reward">Â•ñÂä±: {{ achievement.reward }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÂÆóÈó®Èù¢Êùø -->
                    <div v-if="activeLeftTab === 'sect'" class="tab-content">
                        <div v-if="!player.sect" class="sect-selection">
                            <h4>ÈÄâÊã©ÂÆóÈó®</h4>
                            <div class="sects-grid">
                                <div 
                                    v-for="sect in availableSects" 
                                    :key="sect.id"
                                    class="sect-card"
                                    @click="joinSect(sect.id)"
                                >
                                    <div class="sect-icon">{{ sect.icon }}</div>
                                    <h5>{{ sect.name }}</h5>
                                    <p>{{ sect.description }}</p>
                                    <div class="sect-bonus">ÁâπËâ≤: {{ sect.bonus }}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div v-if="player.sect" class="sect-info">
                            <div class="sect-header">
                                <div class="sect-icon">{{ getSectInfo().icon }}</div>
                                <div>
                                    <h4>{{ getSectInfo().name }}</h4>
                                    <p>Ë¥°ÁåÆÂ∫¶: {{ player.sectContribution }}</p>
                                    <p>Á≠âÁ∫ß: {{ player.sectLevel }}</p>
                                </div>
                            </div>
                            
                            <div class="sect-tasks">
                                <h5>ÂÆóÈó®‰ªªÂä°</h5>
                                <div 
                                    v-for="task in sectTasks" 
                                    :key="task.id"
                                    class="task-card"
                                >
                                    <h6>{{ task.name }}</h6>
                                    <p>{{ task.description }}</p>
                                    <div class="task-reward">Â•ñÂä±: {{ task.reward }}</div>
                                    <button 
                                        @click="acceptTask(task.id)"
                                        :disabled="task.accepted || !task.available"
                                        class="task-btn"
                                    >
                                        {{ task.accepted ? 'Â∑≤Êé•Âèó' : 'Êé•Âèó‰ªªÂä°' }}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
                
                <!-- ‰∏≠Â§ÆÂÜÖÂÆπÂå∫ -->
                <section class="center-content">
                    <div class="center-tabs">
                        <button 
                            v-for="tab in centerTabs" 
                            :key="tab.id"
                            :class="['center-tab', { active: activeCenterTab === tab.id }]"
                            @click="activeCenterTab = tab.id"
                        >
                            {{ tab.icon }} {{ tab.name }}
                        </button>
                    </div>
                    
                    <!-- Êé¢Á¥¢ÂÜÖÂÆπ -->
                    <div v-if="activeCenterTab === 'adventure'" class="center-panel">
                        <div class="locations-grid">
                            <div 
                                v-for="location in locations" 
                                :key="location.id"
                                class="location-card"
                            >
                                <div class="location-image">{{ location.icon }}</div>
                                <h4>{{ location.name }}</h4>
                                <p>{{ location.description }}</p>
                                <div class="location-rewards">
                                    <span>‰øÆ‰∏∫: {{ location.baseExp }}</span>
                                    <span>ÈáëÂ∏Å: {{ location.baseGold }}</span>
                                </div>
                                <button 
                                    @click="exploreLocation(location.id)"
                                    :disabled="exploring"
                                    class="explore-btn"
                                >
                                    {{ exploring ? 'Êé¢Á¥¢‰∏≠...' : 'ÂºÄÂßãÊé¢Á¥¢' }}
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÊàòÊñóÂÜÖÂÆπ -->
                    <div v-if="activeCenterTab === 'battle'" class="center-panel">
                        <div v-if="!inBattle" class="enemies-grid">
                            <div 
                                v-for="enemy in enemies" 
                                :key="enemy.id"
                                class="enemy-card"
                            >
                                <div class="enemy-avatar">{{ enemy.avatar }}</div>
                                <h4>{{ enemy.name }}</h4>
                                <div class="enemy-stats">
                                    <div>ÁîüÂëΩ: {{ enemy.hp }}</div>
                                    <div>ÊîªÂáª: {{ enemy.attack }}</div>
                                    <div>Èò≤Âæ°: {{ enemy.defense }}</div>
                                </div>
                                <div class="enemy-rewards">
                                    <span>‰øÆ‰∏∫: {{ enemy.exp }}</span>
                                    <span>ÈáëÂ∏Å: {{ enemy.gold }}</span>
                                </div>
                                <button @click="startBattle(enemy.id)" class="challenge-btn">
                                    ÊåëÊàò
                                </button>
                            </div>
                        </div>
                        
                        <!-- ÊàòÊñóÁïåÈù¢ -->
                        <div v-if="inBattle" class="battle-arena">
                            <div class="battle-participants">
                                <div class="participant player">
                                    <div class="participant-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                                    <h4>{{ currentUser.username }}</h4>
                                    <div class="health-bar">
                                        <div class="health-fill" :style="{ width: (player.hp / player.maxHp) * 100 + '%' }"></div>
                                        <span>{{ player.hp }}/{{ player.maxHp }}</span>
                                    </div>
                                </div>
                                
                                <div class="vs">VS</div>
                                
                                <div class="participant enemy">
                                    <div class="participant-avatar">{{ currentEnemy.avatar }}</div>
                                    <h4>{{ currentEnemy.name }}</h4>
                                    <div class="health-bar">
                                        <div class="health-fill" :style="{ width: (currentEnemy.hp / currentEnemy.maxHp) * 100 + '%' }"></div>
                                        <span>{{ currentEnemy.hp }}/{{ currentEnemy.maxHp }}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="battle-actions">
                                <button @click="battleAction('attack')" class="battle-btn">‚öîÔ∏è ÊîªÂáª</button>
                                <button @click="battleAction('skill')" :disabled="player.mp < 10" class="battle-btn">üî• ÊäÄËÉΩ</button>
                                <button @click="battleAction('heal')" :disabled="player.mp < 8" class="battle-btn">üíö Ê≤ªÁñó</button>
                                <button @click="battleAction('defend')" class="battle-btn">üõ°Ô∏è Èò≤Âæ°</button>
                            </div>
                            
                            <div class="battle-log">
                                <div v-for="(message, index) in battleMessages" :key="index" class="battle-message">
                                    {{ message }}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÂïÜÂ∫óÂÜÖÂÆπ -->
                    <div v-if="activeCenterTab === 'shop'" class="center-panel">
                        <div class="shop-tabs">
                            <button 
                                v-for="category in shopCategories" 
                                :key="category.id"
                                :class="['shop-tab', { active: activeShopCategory === category.id }]"
                                @click="activeShopCategory = category.id"
                            >
                                {{ category.icon }} {{ category.name }}
                            </button>
                        </div>
                        
                        <div class="shop-items">
                            <div 
                                v-for="item in getShopItems()" 
                                :key="item.id"
                                class="shop-item"
                            >
                                <div class="item-icon">{{ item.icon }}</div>
                                <h4>{{ item.name }}</h4>
                                <p>{{ item.description }}</p>
                                <div class="item-price">{{ item.price }} ÈáëÂ∏Å</div>
                                <button 
                                    @click="buyItem(item)"
                                    :disabled="player.gold < item.price"
                                    class="buy-btn"
                                >
                                    Ë¥≠‰π∞
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Âè≥‰æßÈù¢Êùø -->
                <aside class="right-panel">
                    <div class="panel-tabs">
                        <button 
                            v-for="tab in rightTabs" 
                            :key="tab.id"
                            :class="['tab-btn', { active: activeRightTab === tab.id }]"
                            @click="activeRightTab = tab.id"
                        >
                            {{ tab.icon }} {{ tab.name }}
                        </button>
                    </div>
                    <!-- Ê∏∏ÊàèÊó•ÂøóÈù¢Êùø -->
                    <div v-if="activeRightTab === 'log'" class="tab-content">
                        <div class="panel-header">
                            <h4>üìú Ê∏∏ÊàèÊó•Âøó</h4>
                        </div>
                        <div class="game-log">
                            <div 
                                v-for="(log, index) in gameLogs" 
                                :key="index"
                                :class="['log-entry', log.type]"
                            >
                                <span class="log-time">{{ log.time }}</span>
                                <span class="log-message">{{ log.message }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÁÇº‰∏πÈù¢Êùø -->
                    <div v-if="activeRightTab === 'alchemy'" class="tab-content">
                        <div class="alchemy-container">
                            <h4>üß™ ÁÇº‰∏πÁÇâ</h4>
                            
                            <div class="alchemy-furnace">
                                <div class="furnace-status">
                                    <div v-if="alchemyInProgress" class="furnace-active">
                                        <div class="fire-animation">üî•</div>
                                        <p>ÁÇºÂà∂‰∏≠... {{ alchemyTimeLeft }}Áßí</p>
                                        <div class="progress-bar">
                                            <div class="progress-fill" :style="{ width: ((alchemyDuration - alchemyTimeLeft) / alchemyDuration) * 100 + '%' }"></div>
                                        </div>
                                    </div>
                                    <div v-else class="furnace-idle">
                                        <div class="furnace-icon">‚öóÔ∏è</div>
                                        <p>ÁÇº‰∏πÁÇâÁ©∫Èó≤‰∏≠</p>
                                    </div>
                                </div>
                                
                                <div class="recipe-selection">
                                    <h5>ÈÄâÊã©‰∏πÊñπ</h5>
                                    <div class="recipes-grid">
                                        <div 
                                            v-for="recipe in alchemyRecipes" 
                                            :key="recipe.id"
                                            :class="['recipe-card', { available: canCraftRecipe(recipe) }]"
                                            @click="startAlchemy(recipe)"
                                        >
                                            <div class="recipe-icon">{{ recipe.icon }}</div>
                                            <h6>{{ recipe.name }}</h6>
                                            <div class="recipe-materials">
                                                <div v-for="material in recipe.materials" :key="material.name" class="material">
                                                    {{ material.name }} x{{ material.count }}
                                                </div>
                                            </div>
                                            <div class="recipe-result">‰∫ßÂá∫: {{ recipe.result }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ë£ÖÂ§áÂº∫ÂåñÈù¢Êùø -->
                    <div v-if="activeRightTab === 'enhance'" class="tab-content">
                        <div class="enhance-container">
                            <h4>‚öíÔ∏è Ë£ÖÂ§áÂº∫Âåñ</h4>
                            
                            <div class="enhance-area">
                                <div class="equipment-slot">
                                    <h5>ÈÄâÊã©Ë£ÖÂ§á</h5>
                                    <div class="equipment-grid">
                                        <div 
                                            v-for="equipment in getEnhanceableEquipment()" 
                                            :key="equipment.id"
                                            :class="['equipment-card', { selected: selectedEquipment?.id === equipment.id }]"
                                            @click="selectEquipment(equipment)"
                                        >
                                            <div class="equipment-icon">{{ equipment.icon }}</div>
                                            <div class="equipment-info">
                                                <h6>{{ equipment.name }}</h6>
                                                <p>+{{ equipment.level || 0 }}</p>
                                                <div class="equipment-stats">
                                                    <div v-for="(value, stat) in equipment.stats" :key="stat">
                                                        {{ stat }}: +{{ value }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div v-if="selectedEquipment" class="enhancement-panel">
                                    <h5>Âº∫Âåñ {{ selectedEquipment.name }}</h5>
                                    <div class="enhancement-info">
                                        <p>ÂΩìÂâçÁ≠âÁ∫ß: +{{ selectedEquipment.level || 0 }}</p>
                                        <p>ÊàêÂäüÁéá: {{ getEnhanceSuccessRate(selectedEquipment) }}%</p>
                                        <p>ÊâÄÈúÄÊùêÊñô: Âº∫ÂåñÁü≥ x{{ getEnhanceCost(selectedEquipment) }}</p>
                                        <p>ÊâÄÈúÄÈáëÂ∏Å: {{ getEnhanceGoldCost(selectedEquipment) }}</p>
                                    </div>
                                    
                                    <div class="enhancement-preview">
                                        <h6>Âº∫ÂåñÂêéÂ±ûÊÄßÈ¢ÑËßà:</h6>
                                        <div v-for="(value, stat) in getEnhancedStats(selectedEquipment)" :key="stat" class="stat-preview">
                                            {{ stat }}: +{{ selectedEquipment.stats[stat] }} ‚Üí +{{ value }}
                                        </div>
                                    </div>
                                    
                                    <button 
                                        @click="enhanceEquipment(selectedEquipment)"
                                        :disabled="!canEnhanceEquipment(selectedEquipment)"
                                        class="enhance-btn"
                                    >
                                        Âº∫ÂåñË£ÖÂ§á
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
            </main>
        </div>
        
        <!-- ÈÄöÁü•Á≥ªÁªü -->
        <div class="notifications">
            <div 
                v-for="notification in notifications" 
                :key="notification.id"
                :class="['notification', notification.type]"
            >
                {{ notification.message }}
            </div>
        </div>
    </div>
    
    <script src="game.js"></script>
</body>
</html>